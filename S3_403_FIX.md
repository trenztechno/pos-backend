# Fix S3 403 Forbidden Error for Images

## Problem
Images are returning `403 Forbidden` errors when accessed. This means the S3 bucket doesn't have public read permissions configured.

## Quick Fix Steps

### Step 1: Go to AWS S3 Console
1. Open https://console.aws.amazon.com/s3/
2. Find your bucket: `trenz-pos-storage` (or your bucket name)

### Step 2: Check Block Public Access Settings
1. Click on your bucket name
2. Go to **Permissions** tab
3. Scroll to **Block public access (bucket settings)**
4. Click **Edit**
5. **Uncheck all 4 boxes** (or at least uncheck "Block public access to buckets and objects granted through new access control lists (ACLs)")
6. Click **Save changes**
7. Type `confirm` and click **Confirm**

### Step 3: Set Bucket Policy (Public Read Access)
1. Still in **Permissions** tab
2. Scroll to **Bucket policy**
3. Click **Edit**
4. Paste this policy (replace `trenz-pos-storage` with your bucket name):

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::trenz-pos-storage/*"
        }
    ]
}
```

5. Click **Save changes**

### Step 4: Verify CORS Configuration
1. Still in **Permissions** tab
2. Scroll to **Cross-origin resource sharing (CORS)**
3. Click **Edit**
4. Paste this configuration:

```json
[
    {
        "AllowedHeaders": ["*"],
        "AllowedMethods": ["GET", "PUT", "POST", "DELETE", "HEAD"],
        "AllowedOrigins": ["*"],
        "ExposeHeaders": []
    }
]
```

5. Click **Save changes**

### Step 5: Test
Run the test again:
```bash
python test_mobile_dev_setup.py
```

All images should now return `200 OK` instead of `403 Forbidden`.

## Alternative: Use Pre-Signed URLs (More Secure)

If you don't want public access, you can use pre-signed URLs instead. This requires code changes to generate temporary URLs for each image access.

## Verification

After fixing, you should see:
- ✅ Images accessible: 15/15
- ✅ No 403 errors
- ✅ All image URLs return 200 OK

## Important Notes

- **Public read access** means anyone with the URL can view the image
- This is fine for product images and logos (they're meant to be public)
- For sensitive images, use pre-signed URLs instead
- The bucket policy only allows `GetObject` (read), not `PutObject` (write) - so it's safe


